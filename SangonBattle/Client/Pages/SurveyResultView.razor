@page "/result/{ResultId:int}"

@inject SurveyRepository _surveyRepository
@inject NavigationManager _navigationManager
<div class="container text-center">

    @if (_surveyResult == null)
    {
        @if (_resultNotFound)
        {
            <h4>결과를 찾을 수 없어요 ㅠ...</h4>
        }
        else
        {
            <p>결과를 계산중입니다....</p>
        }
    }
    else
    {
        <h3>당신과 어울리는 맥주는?!</h3>

        <button type="button" class="btn btn-primary"
                @onclick="Restart">
            다시하기
        </button>
    }
</div>


@code {
    [Parameter] public int ResultId { get; set; }
    private ISurveyResult _surveyResult = null;
    private bool _resultNotFound = false;

    protected override async Task OnInitializedAsync()
    {
        _surveyResult = await _surveyRepository.GetResult(ResultId);

        await Task.Delay(1000);

        //In case of Not found
        if (_surveyResult == null)
        {
            _resultNotFound = true;
        }
    }

    private void Restart()
    {
        _navigationManager.NavigateTo("/");
    }
}
